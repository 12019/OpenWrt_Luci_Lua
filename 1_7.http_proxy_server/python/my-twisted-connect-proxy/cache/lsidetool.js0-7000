var sidebar={sideBar:null,sideBar_w970:null,sideBar_w970_custom:null,subEle:null,rightSidebar:null,closeIcon:null,subData:null,recData:null,isWide:!1,loadingImg:null,userInfoTip:null,sidebarMask:null,haveLoaded:!1,nHaveLoaded:!1,isNsidebarPopout:!1,init:function(){var e=this;e.initGlobalValue(),e.switchLinkOpen(),e.initSize(),e.checkToolSize(),e.hideNarrowBarInVpageInIE8AtLowWidth(),e.initGlobalEvents(),e.appendShowSubBtnInVpage()},initGlobalValue:function(){var e=this;e.sideBar=jQuery("#ykSideBar"),e.sideBar_w970=jQuery("#ykSidebar_w970"),e.sideBar_w970_custom=jQuery("#ykSidebar_w970_custom"),e.subEle=jQuery("#ykSideSub"),e.nSubEle=jQuery("#yknSideSub"),e.rightSidebar=jQuery("#rightSidebar"),e.closeIcon=e.rightSidebar.find(".closeIcon"),e.sidebarMask=jQuery("#sidebarMask"),e.loadingImg=jQuery('<img style="width: 64px;height: 62px;position: relative;top: 50%;left: 50%;margin:-31px 0 0 -32px; " src="http://static.youku.com/index/img/2013/loading_64.gif" alt="正在加载"/>'),e.userInfoTip=jQuery('<div class="detailTip"><iframe class="detailTip_mask" frameBorder="0" scrolling="no"></iframe><img src=""/><h2 class="userName"></h2><div id="tipSub" class="sub-btn">订阅</div><div class="arrow"></div></div>'),e.miniSidebar=jQuery("#miniSidebar")},initSize:function(){var e=sidebar,i=e.sideBar.height(),a=i-330,s=e.subEle.find("#subscribeBody")[0];if(e.subEle.height(a),s){var t=e.subEle.height()-48;jQuery(s).height(t)}var r=e.sideBar_w970[0]?e.sideBar_w970:e.sideBar_w970_custom,o=r.height(),n=o-410,d=jQuery("#yknSideSub");d.height(n)},checkToolSize:function(){var e=this,i=i=window.innerWidth||"CSS1Compat"==document.compatMode?document.documentElement.clientWidth:document.body.clientWidth,a=e.sideBar_w970[0],s=e.sideBar_w970[0]?e.sideBar_w970:e.sideBar_w970_custom;a&&(1400>i&&i>=1075?(e.isWide=!1,e.nHaveLoaded||e.loadSubDataToNsidebar(),e.sidebarMask.css({left:"-110px"})):i>=1400?(e.isWide=!0,e.haveLoaded||e.loadSubscribeData(),e.sidebarMask.css({left:"0px"})):1075>i&&(e.isWide=!1,e.sidebarMask.css({left:"-141px"}),s.css({display:"block",left:"-50px"})))},appendShowSubBtnInVpage:function(){var e=this,i=jQuery('<a class="showSubBtn"><p class = "text">订阅<br/>列表</p><div class="icon"></div></a>');if(e.sideBar_w970_custom[0]){var a=e.sideBar_w970_custom.find("#yknSideSub");i.on("click",function(){i.remove(),e.loadSubDataToNsidebar()}).appendTo(a)}},switchLinkOpen:function(){var e=this,i=document.location.href,a=/v\.youku\.com\/v_show/i,s=a.test(i);s?(e.sideBar.find("a:not(.subBtn)").attr("target","lsidetool"),e.sideBar_w970_custom.find("a").attr("target","lsidetool")):(e.sideBar.find("a:not(.subBtn)").attr("target","_self"),e.sideBar_w970.find("a").attr("target","_self"))},hideNarrowBarInVpageInIE8AtLowWidth:function(){var e=this,i=document.location.href,a=/v\.youku\.com\/v_show/i,s=a.test(i);if(s){var t=window.innerWidth;"number"!=typeof t&&(t="CSS1Compat"==document.compatMode?document.documentElement.clientWidth:document.body.clientWidth,1100>t||t>1255&&1290>t?(e.sideBar_w970_custom.hide(),e.sidebarMask.css({left:"-160px"})):(e.sideBar_w970_custom.show(),e.sidebarMask.css({left:"-110px"})))}},switchLsideTool:function(){var e=this,i=jQuery(document.body),a=window.innerWidth,s=e.sideBar_w970.children().length,t=e.sideBar_w970[0]?e.sideBar_w970:e.sideBar_w970_custom;switch("number"!=typeof a&&(a="CSS1Compat"==document.compatMode?document.documentElement.clientWidth:document.body.clientWidth),!0){case 1075>a:e.isWide=!1,t.is(":animated")||t.css({display:"block"}).animate({left:"-50px"},200,function(){e.miniSidebar.show(),e.isNsidebarPopout=!0}),e.sideBar.is(":animated")||e.sidebarMask.is(":animated")||e.sideBar.animate({left:"-160px"},300),e.sidebarMask.css({left:"-141px"}),i.hasClass("body-offset-w1190")?i.removeClass("body-offset-w1190").addClass("body-offset-mini"):i.hasClass("body-offset-w970")?i.removeClass("body-offset-w970").addClass("body-offset-mini"):i.addClass("body-offset-mini");break;case 1400>a&&a>=1075:e.isWide=!1,t.is(":animated")||t.css({display:"block"}).animate({left:"0px"},200,function(){e.miniSidebar.hide(),e.isNsidebarPopout=!1}),e.sidebarMask.css({left:"-110px"}),s&&(e.nHaveLoaded||e.loadSubDataToNsidebar(),e.sideBar.is(":animated")||e.sidebarMask.is(":animated")||e.sideBar.animate({left:"-160px"},300)),i.hasClass("body-offset-w1190")?i.removeClass("body-offset-w1190").addClass("body-offset-w970"):i.hasClass("body-offset-mini")?i.removeClass("body-offset-mini").addClass("body-offset-w970"):i.addClass("body-offset-w970");break;case a>=1400:e.isNsidebarPopout=!1,s?(e.isWide=!0,i.hasClass("body-offset-w970")?i.removeClass("body-offset-w970").addClass("body-offset-w1190"):i.hasClass("body-offset-mini")?i.removeClass("body-offset-mini").addClass("body-offset-w1190"):i.addClass("body-offset-w1190"),e.sidebarMask.css({left:"0px"}),e.sideBar.is(":animated")||e.sidebarMask.is(":animated")||e.sideBar.css({display:"block"}).animate({left:"0px"},300,function(){e.sideBar_w970.css({display:"block",left:"-50px"}),e.haveLoaded||e.loadSubscribeData()})):(e.sidebarMask.css({left:"-110px"}),t.is(":animated")||"-50px"!=t.css("left")||t.css({display:"block"}).animate({left:"0px"},200,function(){e.miniSidebar.hide()}))}},switchNavTab:function(e){var i,a,s=jQuery(".ykSideMenu"),t=s.length;if(t)for(var r=0;t>r;r++)a=jQuery(s[r]),i=a.children(),jQuery(i[e]).find("a").addClass("selected")},initGlobalEvents:function(){var e=this,i=null,a=e.sideBar_w970[0]?e.sideBar_w970:e.sideBar_w970_custom;jQuery(window).resize(function(){e.initSize(),e.switchLsideTool(),e.hideNarrowBarInVpageInIE8AtLowWidth()}),e.miniSidebar.on("click",function(){e.sidebarMask.css({left:"-110px"}),a.css({display:"block",left:"-50px"}).animate({left:"0px"},300,function(){e.miniSidebar.hide(),e.isNsidebarPopout=!0,e.sideBar_w970[0]&&!e.nHaveLoaded&&e.loadSubDataToNsidebar()})}),a.on("mouseleave",function(){e.userInfoTip.remove(),e.isNsidebarPopout&&"0px"==a.css("left")&&(i=setTimeout(function(){e.sidebarMask.css({left:"-160px"}),a.is(":animated")||a.animate({left:"-50px"},200,function(){e.miniSidebar.show(),clearTimeout(i)})},3e3))}).on("mouseenter",function(){clearTimeout(i)}).on("click",function(e){e.stopPropagation()}),jQuery("body").on("click",function(){e.isNsidebarPopout&&"0px"==a.css("left")&&(e.sidebarMask.css({left:"-160px"}),a.is(":animated")||a.animate({left:"-50px"},200,function(){e.miniSidebar.show(),clearTimeout(i)}))})},loadSubDataToNsidebar:function(){var e=this,i=jQuery("#yknSideSub").height(),a=i/44;a=Math.floor(a),a=a>15?15:a,e.loadSubscribeData(a,2)},loadSubscribeData:function(e,i){var a=this,s={page_length:e||20,type:i||2};a.isWide?a.loadingImg.css({width:"64px",height:"62px",margin:"-31px 0 0 -32px"}).appendTo(a.subEle):a.loadingImg.css({width:"40px",height:"40px",margin:"-20px 0 0 -20px"}).appendTo(a.nSubEle),jQuery.ajax({url:"http://www.youku.com/index/getUserSubList",type:"GET",data:s,dataType:"JSONP",timeout:5e3,success:function(i){a.subData=i,0===i.length?(e-=1,a.getRecmmondData(e)):a.i